* TODO
** Allow deletion from database
** change bibtex key format - update document
** windows problem
var wm = Components.classes["@mozilla.org/appshell/window-mediator;1"]
                     .getService(Components.interfaces.nsIWindowMediator);
var win = wm.getMostRecentWindow("navigator:browser"); 
** store bibtex key format for each bibtex file
* Requests
** update lyz from bibtex file 
** Notification about current doc and citekey
** Doc and bib in subversion
* Would be nice
** not initialized when new window opened
** incompatibility with zotfile
find out how to properly insert lyz menu into zotero menu

* NOTES
** only one window
The problem is that you're keeping central state (which most Firefox
extensions don't do, but you're piggybacking on Zotero's core object)
but trying to do window-specific things. If you're storing things in a
core object, you need to pass the relevant window/document to the
functions. So pass document to createUI() and pass window to settings()
(and do the same for anything else that needs a window) and change the
methods to take those parameters, and then it should work. 

** svn management
1) We use a group library for the reference and the key format would be the same for all authors. Currently we just export the entire library as a bibtex file whenever a change is made and replace the existing file. With this new plugin I see two scenarios that can result in duplicates. (I assume that you know how subversion works.)

a) Two people edit the document at the same time and add the same citation. In this case subversion either detects that the bibtex files are identical and just uses one of these. If the authors also add other citations so that the bibtex files are no longer identical, this would create a conflict. So no problem here.

b) One person adds a citation and commits the bibtex file. A second person updates his working copy and now has a bibtex file containing the said reference. When he now cites this reference, it is added to the bibtex file again. This is a problem that can be solved only by your plugin.

* ZOTERO
** disable search for string shorter than 2?
** single instance of zotero


* Firefox
•extensions.logging.enabled:
•javascript.options.showInConsole:
•browser.dom.window.dump.enabled

ircs://irc.mozilla.org:6697/extdev